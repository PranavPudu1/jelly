# Dark Mode Implementation Plan

## Overview
Implement a dark mode toggle that allows users to switch between light and dark themes throughout the app. The preference will be persisted and accessible from the Profile screen.

## Current Architecture Analysis

### Theme System
- **Static Colors**: `app/src/theme/colors.ts` exports a static `AppColors` object
- **Usage**: 14 files use AppColors with 183 total usages
- **Pattern**: Components import AppColors directly from theme

### Context Pattern
- Existing contexts: `UserContext`, `LocationContext`, `SavedRestaurantsContext`
- Pattern: Context + Provider wrapper + custom hook
- Persistence: SavedRestaurantsContext uses AsyncStorage with `@saved_restaurants` key
- Provider hierarchy in `App.tsx`: UserContextWrapper → LocationProvider → SavedRestaurantsProvider

### Profile Screen
- Already has menu structure with Account and Support sections
- Uses TouchableOpacity menu items with icons
- Perfect location for dark mode toggle

## Implementation Strategy

### Approach: Theme Context with Dynamic Colors
Create a ThemeContext that provides dynamic colors based on light/dark mode state, following the existing context pattern.

**Why this approach:**
- ✅ Follows existing context architecture
- ✅ Type-safe with TypeScript
- ✅ Clean separation of concerns
- ✅ Persistent across app sessions
- ✅ Standard React pattern

## Files to Create

### 1. `app/src/theme/darkColors.ts`
Dark mode color palette matching the structure of `colors.ts`:
```typescript
export const DarkColors = {
  // Dark variants of all AppColors
  primary: '...',
  background: '#121212',
  white: '#1E1E1E',
  textDark: '#FAFAFA',
  // ... etc
}
```

### 2. `app/src/contexts/ThemeContext.tsx`
Theme provider following SavedRestaurantsContext pattern:
- State: `isDarkMode: boolean`
- Functions: `toggleTheme()`, `setTheme(isDark: boolean)`
- Persistence: AsyncStorage with `@theme_preference` key
- Hook: `useTheme()` returns current colors + theme state + toggle function
- Returns the appropriate color palette (AppColors or DarkColors)

## Files to Modify

### 3. `app/App.tsx`
Add ThemeProvider to context hierarchy:
```typescript
<ThemeProvider>
  <UserContextWrapper>
    <LocationProvider>
      <SavedRestaurantsProvider>
        {/* existing navigation */}
```

Position: Outermost wrapper since theme affects everything

### 4. `app/src/screens/UserProfileScreen.tsx`
Add dark mode toggle in Account section:
- Add toggle between "Edit Profile" and "Preferences"
- Use Switch component from react-native
- Toggle text: "Dark Mode"
- Icon: `moon` (outline when off, filled when on)
- Call `toggleTheme()` from useTheme hook

### 5. Update All Component Files (13 files)
Replace static `AppColors` imports with `useTheme()` hook:

**Pattern change:**
```typescript
// Before
import { AppColors } from '../theme';
const styles = StyleSheet.create({
  container: { backgroundColor: AppColors.white }
});

// After
import { useTheme } from '../contexts/ThemeContext';
function Component() {
  const { colors } = useTheme();
  const styles = createStyles(colors);
  // ...
}
const createStyles = (colors) => StyleSheet.create({
  container: { backgroundColor: colors.white }
});
```

**Files to update:**
1. `app/src/components/RestaurantCard.tsx`
2. `app/src/components/SavedRestaurantCard.tsx`
3. `app/src/components/MenuModal.tsx`
4. `app/src/components/ReelModal.tsx`
5. `app/src/components/DelightfulButton.tsx`
6. `app/src/components/WelcomeCarousel.tsx`
7. `app/src/components/ErrorNotification.tsx`
8. `app/src/screens/SwipeScreen.tsx`
9. `app/src/screens/SavedRestaurantsScreen.tsx`
10. `app/src/screens/UserProfileScreen.tsx`
11. `app/src/screens/AuthScreen.tsx`
12. `app/src/screens/QuestionnaireScreen.tsx`
13. `app/src/screens/SplashScreen.tsx`

Note: `App.tsx` also uses AppColors for tab bar - update MainTabs function to use useTheme()

## Dark Mode Color Palette Design

Based on Material Design dark theme guidelines:

### Background Colors
- **Background**: `#121212` (main background)
- **Surface**: `#1E1E1E` (cards, elevated surfaces)
- **Surface Variant**: `#2C2C2C` (slightly elevated)

### Primary Colors
- Keep primary `#FEE0DE` (works on dark)
- Adjust accent if needed for contrast
- Secondary may need slight brightening

### Text Colors
- **Text Primary**: `#FAFAFA` (high emphasis)
- **Text Secondary**: `#B0B0B0` (medium emphasis)
- **Text Disabled**: `#6B6B6B` (low emphasis)

### Semantic Colors
- Adjust shadows to be lighter for visibility on dark backgrounds
- Keep brand colors (Instagram, TikTok) unchanged

## Implementation Order

1. **Create dark colors palette** (`darkColors.ts`)
2. **Create ThemeContext** (`ThemeContext.tsx`)
   - Context definition
   - Provider with state management
   - AsyncStorage integration
   - useTheme hook
3. **Integrate into App** (`App.tsx`)
   - Add ThemeProvider wrapper
   - Update MainTabs to use useTheme
4. **Add toggle UI** (`UserProfileScreen.tsx`)
   - Add Switch component
   - Wire up to theme context
5. **Update components** (13 files)
   - Convert to dynamic styles pattern
   - Test each component in both themes

## Testing Strategy

After implementation:
1. Toggle dark mode in Profile screen
2. Verify all screens update immediately
3. Test persistence (close/reopen app)
4. Check all components in both modes:
   - Text readability
   - Icon visibility
   - Shadow visibility
   - Button states
   - Modal backgrounds

## Edge Cases & Considerations

1. **System theme**: For now, manual toggle only (future: respect system preference)
2. **Transition animation**: Could add smooth color transitions later
3. **Images**: Some images may need dark mode variants (evaluate later)
4. **Status bar**: Update StatusBar component color based on theme
5. **Navigation bar**: Tab bar colors should update with theme

## Success Criteria

- ✅ Toggle in Profile screen switches between light/dark mode
- ✅ All screens and components update immediately
- ✅ Theme preference persists across app restarts
- ✅ No visual glitches or flashing
- ✅ All text is readable in both modes
- ✅ All components maintain proper contrast ratios
